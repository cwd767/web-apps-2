<% for post in @posts %>
  <div style="background:#fff; border:1px solid #dbdbdb; border-radius:3px; margin-bottom:24px;">

    <%# ── Post header ── %>
    <div style="display:flex; align-items:center; padding:14px 16px;">
      <div style="width:42px; height:42px; border-radius:50%; background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888); padding:2px; margin-right:12px; flex-shrink:0;">
        <div style="width:100%; height:100%; border-radius:50%; background:#fff; border:2px solid #fff; display:flex; align-items:center; justify-content:center; font-weight:600; font-size:15px; color:#262626;">
          <%= (post["author"].presence || "?").first.upcase %>
        </div>
      </div>
      <span style="font-weight:600; font-size:14px;"><%= post["author"].presence || "tacofan" %></span>
      <span style="margin-left:auto; font-size:22px; letter-spacing:2px; cursor:pointer; color:#262626; line-height:1;">···</span>
    </div>

    <%# ── Image ── %>
    <div>
      <img src="<%= post["image"] %>" alt="taco post"
           style="width:100%; display:block; max-height:585px; object-fit:cover;">
    </div>

    <%# ── Action buttons ── %>
    <div style="display:flex; justify-content:space-between; padding:10px 16px 4px;">
      <div style="display:flex; gap:16px;">

        <%# Heart %>
        <button class="ig-heart" onclick="toggleHeart(this)"
                style="background:none; border:none; padding:4px; cursor:pointer; display:flex; align-items:center;">
          <svg viewBox="0 0 24 24" fill="none" stroke="#262626" stroke-width="1.5"
               stroke-linecap="round" stroke-linejoin="round" style="width:24px;height:24px;">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
        </button>

        <%# Comment %>
        <button style="background:none; border:none; padding:4px; cursor:pointer; display:flex; align-items:center;">
          <svg viewBox="0 0 24 24" fill="none" stroke="#262626" stroke-width="1.5"
               stroke-linecap="round" stroke-linejoin="round" style="width:24px;height:24px;">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
          </svg>
        </button>

        <%# Share %>
        <button style="background:none; border:none; padding:4px; cursor:pointer; display:flex; align-items:center;">
          <svg viewBox="0 0 24 24" fill="none" stroke="#262626" stroke-width="1.5"
               stroke-linecap="round" stroke-linejoin="round" style="width:24px;height:24px;">
            <line x1="22" y1="2" x2="11" y2="13"/>
            <polygon points="22 2 15 22 11 13 2 9 22 2"/>
          </svg>
        </button>

      </div>

      <%# Bookmark %>
      <button style="background:none; border:none; padding:4px; cursor:pointer; display:flex; align-items:center;">
        <svg viewBox="0 0 24 24" fill="none" stroke="#262626" stroke-width="1.5"
             stroke-linecap="round" stroke-linejoin="round" style="width:24px;height:24px;">
          <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
        </svg>
      </button>
    </div>

    <%# ── Caption & timestamp ── %>
    <div style="padding:4px 16px 14px;">
      <% if post["body"].present? %>
        <p style="margin:0 0 4px; line-height:1.5;">
          <span style="font-weight:600;"><%= post["author"].presence || "tacofan" %></span>
          <%= post["body"] %>
        </p>
      <% end %>
      <p style="font-size:10px; color:#8e8e8e; text-transform:uppercase; letter-spacing:0.3px; margin:0;">
        <%= time_ago_in_words(post.created_at) %> ago
      </p>
    </div>

  </div>
<% end %>

<script>
  function toggleHeart(btn) {
    const svg = btn.querySelector("svg");
    const isLiked = svg.style.fill === "rgb(237, 73, 86)";
    svg.style.fill   = isLiked ? "none"       : "#ed4956";
    svg.style.stroke = isLiked ? "#262626"    : "#ed4956";
  }
</script>
